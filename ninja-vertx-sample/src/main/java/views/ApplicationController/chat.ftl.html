<#import "../layout/defaultLayout.ftl.html" as layout>
    <@layout.myLayout "Home page">
<style>
    .inset {
        box-shadow: inset 0 0 4px #000000;
        -moz-box-shadow: inset 0 0 4px #000000;
        -webkit-box-shadow: inset 0 0 4px #000000;
        width: 400px;
        border-width: 4px;
        padding: 5px;
    }

    input.inset {
        height: 40px;
    }

    div.inset {
        height: 500px;
        margin-top: 60px;
        white-space: pre-wrap
    }

</style>
    <script>
        var eb = new EventBus("/chatroom/");
        eb.onopen = function () {
            eb.registerHandler("chat.to.client", function (err, msg) {
                console.log(msg.body);
                $('#chat').append(msg.body + "\n");
            });
        };

        function send(event) {
            if (event.keyCode == 13 || event.which == 13) {
                var message = $('#input').val();
                if (message.length > 0) {
                    console.info(eb.state);
                    eb.publish("chat.to.server", message);
                    $('#input').val("");
                }
            }
        }
    </script>


    <div id="chat" class="inset"></div>
    <input id="input" type="text" onkeydown="send(event)" class="inset">


</@layout.myLayout>